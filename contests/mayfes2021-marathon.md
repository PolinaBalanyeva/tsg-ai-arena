# TSG LIVE! 6 問題文

## 背景
TSG LIVE! 6 回目！
6 といえば、正六面体のルービックキューブが連想されますね！

## 問題概要
2次元ルービックキューブの初期配置が与えられます。
2次元ルービックキューブは、一辺が長さ $1$ の正方形 $2N \times 2N$ 個から構成されており、
一つ一つの正方形は $1,2,3,4$ のいずれかの色で塗られています。
任意の整数 $r,c$ $(0 \leq r,c < 2N)$ について、上から $r+1$ 行目、左から $c+1$ 列目の正方形をマス $(r,c)$ と表記し、マス $(r,c)$ の色を $A_{r,c}$ $(1 \leq A_{r,c} \leq 4)$ と表します。

2次元ルービックキューブは上下と左右がそれぞれつながっており、マス $(r,c)$ の上下左右に隣接するマスはそれぞれ、
- マス $(r-1 \bmod{2N},c)$
- マス $(r+1 \bmod{2N},c)$
- マス $(r,c-1 \bmod{2N})$
- マス $(r,c+1 \bmod{2N})$

となっています。

一回の操作では以下の操作を実行します。

---

1. 2つの整数 $p$ $(0\le p < 2N)$ および $x$ $(1\le x < 2N)$ と向き (横方向または縦方向) を選択する。
2. 向きに応じて、以下のいずれかを行う。
    * $p + 1$ 行目上にある $2N$ 個のマスについて、それぞれ $x$ 個左にずらす。これによって、マス $(p, k + x)$ はマス $(p,k)$ に移動する。
    * $p + 1$ 列目上にある $2N$ 個のマスについて、それぞれ $x$ 個上にずらす。これによって、マス $(k+x,p)$ はマス $(k,p)$ に移動する。

---

例: $N = 3, p=1,x=2$として左にずらした場合
```
333312
211321
421134
421432
244413
124324
```
↓
```
333312
132121
421134
421432
244413
124324
```

<img src="https://gyazo.com/0eac0c13b7ceb8a5e396d320bab1c05f/raw" alt="左にずらした場合" width="220" height="220">

例: $N = 3, p=5,x=1$において上にずらした場合
```
333312
211321
421134
421432
244413
124324
```
↓
```
333311
211324
421132
421433
244414
124322
```

<img src="https://gyazo.com/2cae4ee293ecedc450807db7f05eca5e/raw" alt="上にずらした場合" width="220" height="220">

---

最終的に、左上の $N \times N$ 個の正方形が色 $1$、右上の $N \times N$ 個の正方形が色 $2$、左下の $N \times N$ 個の正方形が色 $3$、右下の $N \times N$ 個の正方形が色 $4$
となるようにしたいです。

例えば、 $N=3$ の場合は、完成盤面は以下のようになります。
```
111222
111222
111222
333444
333444
333444
```

<img src="https://gyazo.com/a629e20ccfaf786dee8a66c80ae83fbb/raw" alt="完成盤面" width="220" height="220">

なるべく短い操作回数で、なるべく完成された盤面を実現しましょう。

## 注意
操作回数が短く、盤面が完成形に近いほど1テストケースで得られる点数は高くなる。
**完成盤面でなくても、正の点数が与えられる場合がある。** 詳しくはスコア評価の項目に記載している。

## 入出力
### 入力
以下の形式に従って標準入力で与えられる。
各テストケースには固有の整数 $T$ ($1 \leq T \leq 10$) が一行目に書かれていることに注意せよ。

```
$T$
$N$
$A_{0,0}A_{0,1} \cdots A_{0,2N-1}$
$\vdots$
$A_{2N-1,0}A_{2N-1,1} \cdots A_{2N-1,2N-1}$
```

すべての入力は以下の制約を満たす。
- $1 \leq N \leq 20$
- $1 \leq A_{i,j} \leq 4$  $(0 \leq i,j < 2N)$

### 出力
全体の操作回数を $M$ 、$i$ 回目の操作で選んだ二つの整数を $p_i, x_i$ 、向きを示す定数を $d_i$ として、
以下のフォーマットに従って標準出力に出力せよ。 ただし、 $i$ 回目の操作で行を左にずらす場合 $d_i = 0$, 列を上にずらす場合 $d_i = 1$ である。

```
$M$
$d_1\ p_1\ x_1$
$\vdots$
$d_M\ p_M\ x_M$
```

なお、 $M,d_i,p_i,x_i$ は以下の条件を満たしている必要がある。条件を満たしていない提出は受理されない。
- 出力はすべて非負の整数
- $1 \le M \le 10000$
- $0 \le d_i \le 1$
- $0 \le p_i < 2N$
- $1 \le x_i < 2N$

## サンプル・テストケース内訳
テストケースは合計 $10$ 個ある。テストケース 1 ～ 4 はwriterが任意に与えたもので、テストケース 5 ～ 10 はテストケース生成プログラムが $4N^2$ 個のマスをランダムにシャッフルして出力したケースである。
すべてのサンプルケースおよびテストケースは**公開されている。**


---

### サンプルケース
```
0
2
1122
1122
3344
4433
```
このサンプルケースは採点に含まれない。例えば、以下の出力をすることによって、想定される最大の点数である $\displaystyle 1000-\frac{1\times 40}{2^2}=990$ 点を得ることができる。 
```
1
0 3 2
```
また、以下の出力をすると、$\displaystyle 1000 \times \frac{1}{\mathrm{pow}(2,\frac{10\times 2}{2^2})} -\frac{2\times 40}{2^2}=11$ 点を得ることができる
```
1
0 3 1
```
---

### テストケース1
```
1
2
1122
1224
3344
3341
```

---

### テストケース2
```
2
4
11113433
11114322
11113232
11114443
42333242
34232434
24422324
24324234
```

---

### テストケース3
```
3
4
21111122
12221212
11211222
12111222
34344443
34343334
44433334
44433334
```

---

### テストケース4
```
4
4
11112222
11112222
11233244
11444413
33324424
33434432
33124224
33314413
```

---
### テストケース5

```
5
2
1211
3344
4132
3242
```

---
### テストケース6
```
6
3
432314
213443
111224
113133
234422
412324
```

---
### テストケース7
```
7
5
3431324112
3324211423
3214414334
2144414332
2111312232
1442122122
3444334312
2132144142
1433112233
2423143134
```

---
### テストケース8
```
8
7
42131241341424
13432314413433
11444223312132
41121121413343
43431323411124
23334421222324
11211414324211
34132333343413
43434433233413
14221132214343
44122222421124
21222241133412
14422333123211
42414243321422
```

---
### テストケース9
```
9
10
14332133324322431231
22122124214112424434
41234324434144223422
23221311222244311212
33144343331342124423
21414214441421343244
23433143223411434434
42141341441432124222
13132112342312443212
42442243133222214431
22242321311323441134
42233211133312432441
11232213241312332433
23411444143121442143
31134314343141444241
43211111323131231314
13332343212121131414
31443211342332223443
21121331423424414211
23432332312121413313
```

---
### テストケース10
```
10
20
2444244224224233313333233123224124343133
1111243413424412313314113311122324212323
1321334311224312432311213233411412222424
4411311331243222134334434223411211243414
2114123241434124312123124312334434111224
2141313234332231224212221114411221211434
2132142422244142432424114232111113343322
2311113222344243242244344411132442313423
3142323131423433323244413144232444413111
1411133313441444431134241132224132122332
4323132141243441444144413441144121142321
1233442132341431334313112111313223232221
4134233323124313114132243441341443411323
1334214413342243421112232131424123434321
1424214443223244222244242231134331142232
2422342341134244222113322123112412134144
3134142414124123422241323141222411114344
3124241212421224223334444423444134132212
4434133243132133232222341441311313422232
1431224444122124141344334242321224243313
4224433324433213342114241443132341344241
3132432312233112131334311233314142123114
4342331433112442413214212422344434344323
1121211124331121213122134114413134221443
1433233124343433334121113214232324413331
4432321312241133214214211411211312132111
2321133431142233433234421424122232341442
2143322214434342224113432134432334332323
4223323332131111321411243133214144341444
4421243221132122134311131331423411431231
4132414412324413141332411211124242133443
1433443123424331111444224243332433133222
2233343312234342234122123441424433334133
2341231133444143123341221212134133134234
4441324332413131113223244341214412234344
1414242132132412141331412421221244223222
2431141223334213234143344323231341344321
1224233121144221442414122411334234212432
2112231342342211134443321241224114432213
3133113421111423244234431332423122422421
```

---

## スコア評価
$T$番目のテストケースにおける点数 $\mathrm{Score}(T)$ は以下の式によって計算される。
出力が条件を満たしていない場合
- $\mathrm{Score}(T) = 0$

出力が条件を満たしている場合
- 出力の操作を行なった後の盤面が、完成盤面と異なるマスの個数が $i$ 個、 出力の操作回数が $M$ 回である時
$\displaystyle \mathrm{Score}(T) = \max \left(0, \left\lfloor 1000 \times \frac{1}{\mathrm{pow}\left(2, \frac{10i}{N^2}\right)} - \frac{M}{N^2} \times 40 \right\rfloor\right )$


一回の提出におけるスコアは、$\displaystyle \sum_{T=1}^{10} \mathrm{Score}(T)$ によって計算される。


完成盤面と異なるマスの個数 $i$ 、および出力の操作回数 $M$ が点数に与える影響は以下のグラフの通りとなる。
(横軸は $i,M$ そのものではなく、$i,M$ を盤面の大きさ $N^2$ で割った値であることに注意せよ。)

![](/img/contest/mayfes2021/i.svg)

![](/img/contest/mayfes2021/m.svg)
